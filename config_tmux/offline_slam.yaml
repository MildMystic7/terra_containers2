session_name: docker_session
environment:
 CONTAINER_NAME: "docker-realsense_ros2-1"
shell_command_before:
  - xhost +local:docker
  - docker exec -it $CONTAINER_NAME bash
  - . /opt/ros/humble/setup.bash 
windows:
  - window_name: Main panel
    layout: tiled
    panes:
      - shell_command:
        # point cloud manager node
        - . install/setup.bash
        - colcon build --packages-select point_cloud_manager 
        - ros2 run point_cloud_manager filter
      - shell_command:
        # Start SLAM node
        - colcon build --packages-select gravity_align orbslam3 
        - . install/setup.bash
        # - ros2 launch ov_msckf subscribe.launch.py config:=enza_d455
        - ros2 run gravity_align tf_broadcaster > /dev/null 2>&1 &
        - ros2 run orbslam3 stereo src/orbslam3_ros2/vocabulary/ORBvoc.txt src/orbslam3_ros2/config/stereo/Enza_D455.yaml false
      - shell_command:
        # Bag play
        - cd /data
        - sleep 20
        - ros2 bag play -r 0.25 rosbag2_takodana_2025_04_08-16_03_52
        # - ros2 bag play -r 0.25 rosbag2_vineyard_2025_04_10-10_28_48
      - shell_command:
        - colcon build --packages-select segmentation
        - . install/setup.bash
        - ros2 run segmentation segment_ndvi
  - window_name: Ros nodes
    layout: tiled
    panes:
      - shell_command:
        - rviz2 -d ./config_rviz/slam_two_classes.rviz
        # - ros2 run tf2_ros static_transform_publisher 0 0 0 0.5 -0.5 0.5 0.5 cam0 camera_link
  
global_options:
  mouse: on